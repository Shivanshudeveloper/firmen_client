"use strict";(self.webpackChunk_minimal_minimal_kit_react=self.webpackChunk_minimal_minimal_kit_react||[]).push([[4887],{24887:function(e,n,t){t.r(n);var a=t(4942),i=t(74165),r=t(93433),c=t(15861),s=t(29439),l=t(1413),o=t(45987),d=t(72791),u=t(20890),h=t(5574),x=t(65661),p=t(39157),Z=t(51691),j=t(48550),m=t(81918),f=t(97123),g=t(24518),v=t(61889),b=t(57621),y=t(39504),w=t(35527),k=t(20068),P=t(90493),C=t(45484),S=t(13400),I=t(20653),_=t(60220),W=t(49900),B=t(94721),E=t(2101),F=t(43896),A=t(64554),R=t(85524),M=t(52797),D=t(2216),T=t(27247),U=t(42419),J=(t(97242),t(31243)),N=t(68096),V=t(58406),H=t(77196),L=t(23786),O=t(39281),q=t(79836),z=t(56890),G=t(35855),K=t(53994),Q=t(53382),X=t(94454),Y=t(33805),$=t(11087),ee=t(75985),ne=t(26467),te=t(29598),ae=t(78316),ie=t(20204),re=t.n(ie),ce=t(80184),se=["children","value","index"];function le(e,n,t){return{fontWeight:-1===n.indexOf(e)?t.typography.fontWeightRegular:t.typography.fontWeightMedium}}var oe={PaperProps:{style:{maxHeight:224,width:250}}};function de(e){var n=e.children,t=e.value,a=e.index,i=(0,o.Z)(e,se);return(0,ce.jsx)("div",(0,l.Z)((0,l.Z)({role:"tabpanel",hidden:t!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},i),{},{children:t===a&&(0,ce.jsx)(A.Z,{sx:{p:3},children:(0,ce.jsx)(u.Z,{children:n})})}))}function ue(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}var he=["itadmin","admin"];n.default=function(){var e=(0,ae.E)().user,n=(0,te.Z)(),t=d.useState(0),o=(0,s.Z)(t,2),ie=o[0],se=o[1],xe=d.useState(0),pe=(0,s.Z)(xe,2),Ze=pe[0],je=pe[1],me=d.useState(!1),fe=(0,s.Z)(me,2),ge=fe[0],ve=fe[1],be=function(){ve(!1)},ye=(0,d.useState)([]),we=(0,s.Z)(ye,2),ke=we[0],Pe=we[1],Ce=function(){J.Z.get("".concat(Y.BC,"/project/tasks?email=").concat(e.email)).then((function(n){var t=n.data,a=[];t.forEach((function(n){var t=n._id;n.tasks.forEach((function(n){n.members.includes(e.email)&&a.push((0,l.Z)((0,l.Z)({},n),{},{goalId:t}))}))})),Pe(a)}))},Se=(0,d.useState)([]),Ie=(0,s.Z)(Se,2),_e=Ie[0],We=Ie[1],Be=function(){var n=(0,c.Z)((0,i.Z)().mark((function n(){var t;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!he.includes(e.role)){n.next=4;break}J.Z.get("".concat(Y.BC,"/project/").concat(e.company)).then((function(e){We(e.data)})),n.next=13;break;case 4:if("manager"!==e.role){n.next=8;break}J.Z.get("".concat(Y.BC,"/project/").concat(e.company,"?managerId=").concat(e.email)).then((function(e){We(e.data)})),n.next=13;break;case 8:if(t=e.firestore.projects){n.next=11;break}return n.abrupt("return");case 11:We([]),t.map((function(n){J.Z.get("".concat(Y.BC,"/project/").concat(e.company,"?managerId=").concat(n)).then((function(e){We((function(n){return[].concat((0,r.Z)(n),(0,r.Z)(e.data))}))}))}));case 13:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),Ee=(0,d.useState)({name:"",desc:""}),Fe=(0,s.Z)(Ee,2),Ae=Fe[0],Re=Fe[1],Me=function(e){return function(n){Re((function(t){return(0,l.Z)((0,l.Z)({},t),{},(0,a.Z)({},e,n.target.value))}))}},De=(0,d.useState)([]),Te=(0,s.Z)(De,2),Ue=Te[0],Je=Te[1],Ne=function(){var n=(0,c.Z)((0,i.Z)().mark((function n(){var t,a;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ne.RZ.collection(ne.hJ).where("projects","array-contains",e.email).get();case 2:t=n.sent,a=[],t.forEach((function(n){var t=n.data();n.id!==e.uid&&(t.uid=n.id,a.push(t))})),Je(a);case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),Ve=new Map([[0,Be],[1,Ce],[2,Ne],[3,null]]);(0,d.useEffect)((function(){if(e){var n=Ve.get(ie);n&&n()}}),[ie]);var He,Le=(0,d.useState)([]),Oe=(0,s.Z)(Le,2),qe=Oe[0],ze=Oe[1],Ge=(0,d.useState)([]),Ke=(0,s.Z)(Ge,2),Qe=Ke[0],Xe=Ke[1];return(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsxs)(h.Z,{open:ge,onClose:be,maxWidth:"sm",fullWidth:!0,scroll:"body",PaperProps:{sx:{mt:"100px",verticalAlign:"top"}},children:[0===Ze?(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)(x.Z,{variant:"h3",children:"Add Project"}),(0,ce.jsxs)(p.Z,{children:[(0,ce.jsx)(Z.Z,{variant:"h5",children:"Project Name"}),(0,ce.jsx)(j.Z,{autoFocus:!0,margin:"dense",id:"project-name",placeholder:"Mission 101",fullWidth:!0,variant:"outlined",value:Ae.name,onChange:Me("name")}),(0,ce.jsx)("br",{}),(0,ce.jsx)("br",{}),(0,ce.jsx)(Z.Z,{variant:"h5",children:"Brief Description"}),(0,ce.jsx)(j.Z,{margin:"dense",id:"project-desc",multiline:!0,rows:4,placeholder:"Started with ...",fullWidth:!0,variant:"outlined",value:Ae.desc,onChange:Me("desc")})]})]}):null,2===Ze?(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)(x.Z,{variant:"h3",children:"Invite new user/s "}),(0,ce.jsxs)(p.Z,{children:[(0,ce.jsx)(Z.Z,{variant:"h5",children:"Select Employees"}),(0,ce.jsx)(N.Z,{fullWidth:!0,children:(0,ce.jsx)(V.Z,{id:"demo-multiple-chip",multiple:!0,value:qe,onChange:function(e){var n=e.target.value;ze(n)},input:(0,ce.jsx)(H.Z,{id:"select-multiple-chip",label:"Managers"}),renderValue:function(e){return(0,ce.jsx)(A.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map((function(e){return(0,ce.jsx)(m.Z,{label:e},e)}))})},MenuProps:oe,children:Qe.map((function(t){var a;if(null===(a=t.projects)||void 0===a||!a.includes(e.email))return(0,ce.jsx)(L.Z,{value:t.email,style:le(t.email,Qe,n),children:"".concat(t.displayName," (").concat(t.email,")")},t.email)}))})})]})]}):null,(0,ce.jsxs)(f.Z,{children:[(0,ce.jsx)(g.Z,{onClick:be,children:"Cancel"}),(0,ce.jsx)(g.Z,{onClick:(He=Ze,(0,c.Z)((0,i.Z)().mark((function n(){var t,a,r,c;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!==He){n.next=8;break}return t=(0,l.Z)({managerId:e.email,company:e.company},Ae),n.next=4,J.Z.post("".concat(Y.BC,"/project"),{formData:t});case 4:"Created"===(a=n.sent).data?(Be(),Re({name:"",desc:""}),ee.Am.success("New project added")):ee.Am.error(a.data),n.next=9;break;case 8:2===He&&(r=Qe.filter((function(e){return qe.includes(e.email)})),c=[],r.forEach((function(n){c.push(ne.RZ.collection(ne.hJ).doc(n.uid).update({projects:re().firestore.FieldValue.arrayUnion(e.email)}))})),Promise.all(c).then((function(e){Ne(),ze([]),console.log("Team Updated")})));case 9:be();case 10:case"end":return n.stop()}}),n)})))),children:"Add"})]})]}),(0,ce.jsx)(v.ZP,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:(0,ce.jsx)(v.ZP,{item:!0,xs:12,children:(0,ce.jsxs)(A.Z,{sx:{width:"100%"},children:[(0,ce.jsx)(A.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,ce.jsxs)(E.Z,{value:ie,onChange:function(e,n){se(n)},"aria-label":"basic tabs example",children:[(0,ce.jsx)(F.Z,(0,l.Z)({icon:(0,ce.jsx)(R.Z,{}),iconPosition:"start",label:"Projects"},ue(0))),(0,ce.jsx)(F.Z,(0,l.Z)({icon:(0,ce.jsx)(M.Z,{}),label:"My Tasks",iconPosition:"start"},ue(1))),(0,ce.jsx)(F.Z,(0,l.Z)({icon:(0,ce.jsx)(D.Z,{}),label:"Team",iconPosition:"start"},ue(2)))]})}),(0,ce.jsx)(de,{value:ie,index:0,children:(0,ce.jsxs)(v.ZP,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[(0,ce.jsxs)(v.ZP,{item:!0,xs:12,children:[(0,ce.jsx)(u.Z,{sx:{float:"left"},variant:"h3",children:"Projects"}),(0,ce.jsx)(g.Z,{variant:"contained",startIcon:(0,ce.jsx)(U.Z,{}),sx:{float:"right"},onClick:function(){je(0),ve((function(e){return!e}))},children:"Add a new project"})]}),(0,ce.jsx)(v.ZP,{item:!0,xs:12,children:_e.map((function(e){return(0,ce.jsx)(ce.Fragment,{children:(0,ce.jsx)(b.Z,{sx:{mb:2},variant:"outlined",children:(0,ce.jsxs)(y.Z,{children:[(0,ce.jsx)(u.Z,{variant:"h5",children:(0,ce.jsx)($.rU,{style:{textDecoration:"none"},to:"/dashboard/projectview?id=".concat(e._id),state:{title:e.name},children:e.name})}),(0,ce.jsx)(u.Z,{variant:"body1",children:e.desc})]})},e._id)})}))})]})}),(0,ce.jsx)(de,{value:ie,index:1,children:(0,ce.jsxs)(v.ZP,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[(0,ce.jsx)(v.ZP,{item:!0,xs:12,children:(0,ce.jsx)(u.Z,{sx:{float:"left"},variant:"h3",children:"Tasks assigned to you"})}),(0,ce.jsx)(v.ZP,{item:!0,xs:12,children:(0,ce.jsx)(O.Z,{component:w.Z,children:(0,ce.jsxs)(q.Z,{sx:{minWidth:650},"aria-label":"simple table",children:[(0,ce.jsx)(z.Z,{children:(0,ce.jsxs)(G.Z,{children:[(0,ce.jsx)(K.Z,{sx:{width:"25%"},align:"center",children:"Task"}),(0,ce.jsx)(K.Z,{sx:{width:"50%"},align:"center",children:"Description"}),(0,ce.jsx)(K.Z,{sx:{width:"25%"},align:"center",children:"Status"})]})}),(0,ce.jsx)(Q.Z,{children:ke.map((function(e){return(0,ce.jsxs)(G.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,ce.jsx)(K.Z,{align:"center",scope:"row",children:(0,ce.jsx)(u.Z,{sx:{pt:1},variant:"h6",children:(0,ce.jsx)($.rU,{style:{textDecoration:"none"},to:"/dashboard/projectgoal?goalId=".concat(e.goalId,"&projectId=").concat(e.projectId),children:e.name})})}),(0,ce.jsx)(K.Z,{align:"center",variant:"h6",children:e.desc}),(0,ce.jsx)(K.Z,{align:"center",children:(0,ce.jsx)(k.Z,{title:"Mark Completed",children:(0,ce.jsx)(X.Z,{checked:e.status,onChange:(n=e.goalId,t=e._id,function(e){var a=e.target.checked,i={taskId:t,status:a};J.Z.patch("".concat(Y.BC,"/project/goal/").concat(n),{payload:i}).then((function(e){"Updated"===e.data&&Ce()}))}),inputProps:{"aria-label":"controlled"},color:"success"})})})]},e._id);var n,t}))})]})})})]})}),(0,ce.jsx)(de,{value:ie,index:2,children:(0,ce.jsxs)(v.ZP,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[(0,ce.jsxs)(v.ZP,{item:!0,xs:12,children:[(0,ce.jsx)(u.Z,{sx:{float:"left"},variant:"h3",children:"Team"}),(0,ce.jsx)(g.Z,{variant:"contained",startIcon:(0,ce.jsx)(U.Z,{}),sx:{float:"right"},onClick:function(){!function(){var n=ne.RZ.collection(ne.hJ).where("company","==",e.company).where("role","==","employee"),t=[];n.get().then((function(n){n.forEach((function(n){var a=n.data();n.id!==e.uid&&(a.uid=n.id,t.push(a))})),Xe(t)}))}(),je(2),ve((function(e){return!e}))},children:"Add a new user"})]}),(0,ce.jsx)(v.ZP,{item:!0,xs:12,children:(0,ce.jsx)(P.Z,{sx:{p:0},children:Ue.map((function(n,t){return(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsxs)(C.ZP,{id:n.uid,sx:{p:0},secondaryAction:(0,ce.jsx)(S.Z,{edge:"end","aria-label":"delete",sx:{borderRadius:"50%"},onClick:function(){ne.RZ.collection(ne.hJ).doc(n.uid).update({projects:re().firestore.FieldValue.arrayRemove(e.email)}).then((function(e){document.getElementById(n.uid).style.display="none"}))},children:(0,ce.jsx)(T.Z,{})}),children:[(0,ce.jsx)(I.Z,{children:(0,ce.jsx)(_.Z,{alt:"DP",src:n.photoURL})}),(0,ce.jsx)(W.Z,{primary:n.displayName,secondary:n.email})]},n.uid),(0,ce.jsx)(B.Z,{})]})}))})})]})}),(0,ce.jsx)(de,{value:ie,index:3,children:(0,ce.jsx)(v.ZP,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:(0,ce.jsx)(v.ZP,{item:!0,xs:12,children:(0,ce.jsx)(u.Z,{sx:{float:"left"},variant:"h3",children:"Feed"})})})})]})})})]})}}}]);
//# sourceMappingURL=4887.e79ac9f6.chunk.js.map